<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test Session</title>
</head>
<body>

<p>
  При включении Session Managment всегда сначала нужно сделать инициализацию SDK.
  <button id="init" >Init the SDK</button>
</p>

<p>
  После можно сделать запрос (автоматичеси создаётся сессия с READ правами)
  <button id="send_request" >Send a request without user logged</button>
</p>


<!-- 
<button id="initWithParams" >Init the SDK with params</button>
<button id="login" >Login</button>
<button id="logout" >Logout</button>
<button id="send_request_logged" >Send a request as user</button>
<button id="destroy_session" type="button">Destroy the session</button>
 -->
<script src="../quickblox.min.js"></script>

<script>
var config = {
    sessionManagement: {
        enable: true,
        onerror: function() {
            console.error('SDK can\'t reestablish a session. Check out the Internet connection.');
        }
    }
};

var creds = {
  appId: 53036,
  authKey: 'ZdJacVeNw3B3FBF',
  authSecret: 'AQadYv32xN54Oad'
}

// https://adminstage1.quickblox.com/apps
// email sessionmanagment@test.com
// login sessionmanagment
// pass 49249sessionmanagment
// id 247
// var userParams = {
//     email: 'sessionmanagment@test.com',
//     password: '49249sessionmanagment'
// };

var userParams = {
  login: 'chatuser-1',
  password: 'x6Bt0VDy5'
};

var init = document.getElementById('init');
var sendRequest = document.getElementById('send_request');

/** INIT */
init.addEventListener('click', function() {
  QB.init(creds.appId, creds.authKey, creds.authSecret, config);

  console.info('Init the SDK');
  return false;
});

/* SEND REQUEST without user logged */
sendRequest.addEventListener('click', function() {
  QB.users.listUsers(function(err, res){
    console.info('SENT REQUEST without user logged', err, res);
  });

  return false;
});


// var initByParams = document.getElementById('initWithParams');

// var login = document.getElementById('login');
// var logout = document.getElementById('logout');


// var sendRequestLogged = document.getElementById('send_request_logged');

// var destroySession = document.getElementById('destroy_session');

// /* START FUN! */


// /* LOGIN */
// login.addEventListener('click', function() {
//   QB.login(userParams, function(err, result) {
//      // console.log( 'LOGIN Callback', result, err);
//   });

//   return false;
// });



// /* SEND REQUEST with user logged*/
// sendRequestLogged.addEventListener('click', function() {
//     QB.chat.dialog.list(null, function(err, resDialogs) {
//         err ? console.error(err) : console.info(resDialogs);
//     });

//     return false;
// });

// /* DESTRIYED the session */
// destroySession.addEventListener('click', function() {
//     QB.destroySession(function() {
//         console.info('Destroyed the session');
//     });
    
//     return false;
// });

// /* LOGOUT */
// logout.addEventListener('click', function() {
//     QB.logout(function(err, result) {
//         console.log('LOGIN Callback', result, err);
//     });

//     return false;
// });

</script>
</body>
</html>
