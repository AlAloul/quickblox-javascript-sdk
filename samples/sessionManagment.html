<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test Session</title>
</head>
<body>

<button id="init" >Init the SDK</button>
<button id="initWithParams" >Init the SDK with params</button>

<hr>

<button id="login" >Login</button>
<button id="logout" >Logout</button>

<hr>

<button id="send_request" >Send a request without user logged</button>
<button id="send_request_logged" >Send a request as user</button>

<hr>

<button id="destroy_session" type="button">Destroy the session</button>


<script src="../quickblox.min.js"></script>

<script>
var config = {
    endpoints: {
        api: 'apistage1.quickblox.com',
    },
    sessionManagement: {
        enable: true,
        onerror: function() {
            console.info('SDK can\'t reestablish a session. Check out the Internet connection.');
        }
    }
};

var creds = {
    'appId': 21,
    'authKey': '3KZYRV352xJjhEh',
    'authSecret': 'nE7AmRuwGRDwe-r'
}

// https://adminstage1.quickblox.com/apps
// email sessionmanagment@test.com
// login sessionmanagment
// pass 49249sessionmanagment
// id 247
var userParams = {
    email: 'sessionmanagment@test.com',
    password: '49249sessionmanagment'
};

var init = document.getElementById('init');
var initByParams = document.getElementById('initWithParams');

var login = document.getElementById('login');
var logout = document.getElementById('logout');

var sendRequest = document.getElementById('send_request');
var sendRequestLogged = document.getElementById('send_request_logged');

var destroySession = document.getElementById('destroy_session');



/* START FUN! */
init.addEventListener('click', function() {
  QB.init(creds.appId, creds.authKey, creds.authSecret, config)
    .then(function(sessionToken) {
      console.info(`Success init by READ access with token ${sessionToken}`);
    });

    return false;
});

/* LOGIN */
login.addEventListener('click', function() {
  QB.login(userParams, function(err, result) {
     // console.log( 'LOGIN Callback', result, err);
  });

  return false;
});

/* SEND REQUEST without user logged */
sendRequest.addEventListener('click', function() {
  QB.users.listUsers(function(err, res){
    console.info(err, res);
    if(err) {
        console.error(err)
    } else {
        console.info('SEND REQUEST without user logged', res);
    }
  });

  return false;
});

/* SEND REQUEST with user logged*/
sendRequestLogged.addEventListener('click', function() {
    QB.chat.dialog.list(null, function(err, resDialogs) {
        err ? console.error(err) : console.info(resDialogs);
    });

    return false;
});

/* DESTRIYED the session */
destroySession.addEventListener('click', function() {
    QB.destroySession(function() {
        console.info('Destroyed the session');
    });
    
    return false;
});

/* LOGOUT */
logout.addEventListener('click', function() {
    QB.logout(function(err, result) {
        console.log('LOGIN Callback', result, err);
    });

    return false;
});




 

</script>
</body>
</html>
